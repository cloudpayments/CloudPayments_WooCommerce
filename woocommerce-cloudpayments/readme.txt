=== CloudPayments Gateway for WooCommerce ===
Author URI: https://cloudpayments.ru/
Contributors: cpsupport
Tags: woocommerce, payment, payments, cloudpayments
Requires at least: 4.9.7
Tested up to: 5.3
Stable tag: 2.2.2
Requires PHP: 5.2.4
License: GPLv2 or later
License URI: https://www.gnu.org/licenses/gpl-2.0.html

Это официальный модуль Clodpayments, который позволит добавить на ваш магазин woocommerce оплату банковскими картами через платежный сервис [CloudPayments](https://cloudpayments.ru/). Модуль вызывает виджет с адреса https://widget.cloudpayments.ru/bundles/cloudpayments для ввода карточных данных в момент оплаты сформированного заказа. CloudPayments — [сертифицированный](https://cloudpayments.ru/storage/Ttp6LK6sGjrG05WH27MNjLrwGZoxMi06DlV8XL4f.jpeg) сервис провайдер с максимальным уровнем соответствия PCI DSS. Подтверждение соответствия проходит каждый год в рамках сертификационного аудита.


== Description ==

## Возможности:
* Одностадийная схема оплаты;
* Двухстадийная схема;
* Информирование СMS о статусе платежа;
* Выбор языка виджета;
* Выбор дизайна виджета;
* Поддержка онлайн-касс (ФЗ-54);
* Отправка чеков по email;
* Отправка чеков по SMS;
* Теги способа и предмета расчета; 
* Отдельный параметр НДС для доставки.

## Совместимость:

WordPress 4.9.7 и выше;  
WooCommerce 3.4.4 и выше.

== Installation ==

## Установка

1. Скопируйте папку `cloudpayments_for_woocommerce` в директорию `wp-content/plugins/` на вашем сервере или установите плагин напрямую через раздел плагинов WordPress.

2. Зайдите в "Управление сайтом" -> "Плагины". Активируйте плагин "CloudPayments Gateway for WooCommerce".

3. В управлении сайтом зайдите в "WooCommerce" -> "Настройки" -> "Оплата" -> "CloudPayments". Отметьте галочкой  "Enable CloudPayments".

* **Включить/Выключить** - Включение/Отключение платежной системы;  
* **Включить DMS** - Включение двухстадийной схемы оплата платежа (холдирование);  
* **Статус для оплаченного заказа** - **Обработка** (Если не предусматривается другой функционал);  
* **Статус для отмененного заказа** - **Отменен** (Если не предусматривается другой функционал);  
* **Статус авторизованоого платежа DMS** - **На удержании** (Или **Платеж авторизован**, если предусматривается другой функционал);  
* **Наименование** - Заголовок, который видит пользователь в процессе оформления заказа;  
* **Описание** - Описание метода оплаты;  
* **Public_id** - Public id сайта из личного кабинета CloudPayments;  
* **Password for API** - API Secret из личного кабинета CloudPayments;  
* **Валюта магазина** - Российский рубль (Если не предусматривается использовать другие валюты);  
* **Дизайн виджета** - Выбор дизайна виджета из 3 возожных (classic, modern, mini);  
* **Язык виджета** - Русский МСК (Если не предусматривается использовать другие языки);  
* **Включить/Выключить** - Включение формирования заказа в подписках (_версия Subscriptions_).  

Использовать функцуионал онлайн касс:
* **Включить/Выключить** - Включение/отключение формирования онлайн-чека при оплате;  
* **ИНН** - ИНН вашей организации или ИП, на который зарегистрирована касса;  
* **Ставка НДС** - Укажите ставку НДС товаров;  
* **Ставка НДС для доставки** - Укажите ставку НДС службы доставки;  
* **Система налогообложения организации** - Тип системы налогообложения;  
* **Способ расчета** - признак способа расчета;  
* **Предмет расчета** - признак предмета расчета;  
* **Действие со штрих-кодом** - отправление артикула товара в чек как шрих-код;
* **Статус которым пробивать 2ой чек при отгрузке товара или выполнении услуги** - **Выполнен** (Или **Доставлен**, если предусматривается другой функционал)  
_Согласно ФЗ-54 владельцы онлайн-касс должны формировать чеки для зачета и предоплаты. Отправка второго чека возможна только при следующих способах расчета: Предоплата, Предоплата 100%, Аванс._  

Нажмите "Сохранить изменения".

В личном кабинете CloudPayments зайдите в настройки сайта, пропишите в настройках уведомления, как описано на странице настройки модуля на указанный адрес:  
см. Webhook.png)

Вы готовы принимать платежи с банковских карт с помощью CloudPayments!

== Frequently Asked Questions ==

= Какой порядок подключения? =

Для подключения к системе приема платежей CloudPayments, необходимо выполнить следующие действия:
 * Договориться о коммерческих условиях;
 * Ознакомиться с договором-офертой;
 * Заполнить Приложение № 1, подписать, поставить печать и прислать нам на адрес sales@cloudpayments.ru;
 * Выполнить техническую интеграцию сайта;
 * Проверить сайт на соответствие требованиям.  
 
= Как получить URL адрес с копией отправленного онлайн-чека в админ панели магазина? =

Для получения URL адреса копии отправленного онлайн-чека в комментариях к заказу необходимо прописать в личном кабинете CloudPayments адрес для уведомления. Для этого зайдите в настройки сайта, пропишите в настройках адрес: 

* **Receipt Уведомление** (Уведомление об онлайн-чеке):\
http://domain.ru/wordpress/wc-api/wc_cloudkassir?action=receipt

Где domain.ru — доменное имя вашего сайта.
 
== Screenshots ==

1. Настройки модуля settings.png
2. Адреса уведомлений Webhook.png

== Upgrade Notice ==  

= 2.0 =
* Добавлены теги способов и предметов расчета.
* Добавлен обработчик receipt уведомлений

== Changelog ==
= 2.2.2 =
* Устранена ошибка fail уведомления.

= 2.2.1 =
* Устранены незначительные ошибки.

= 2.1 =
* Устранены некоторые ошибки в описании.

= 2.0 =
* Добавлен новый функционал.

= 1.0 =
* Размещение плагина в маркетплейс.

== Changelog == 
